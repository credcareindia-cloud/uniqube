<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIM Fragment Viewer</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="./src/styles.css" />
  </head>
  <body>
    <!-- Main Canvas -->
    <div id="container"></div>

    <!-- Toolbar -->
    <div id="toolbar">
      <button id="tree-toggle-btn" class="toolbar-button">
        <i class="fas fa-sitemap"></i>
        <span class="tooltip">Model Structure</span>
      </button>
      <h1 id="modelName"><span>Uni</span>Qube</h1>
      <button id="selection-tool-btn" class="toolbar-button">
        <i class="fas fa-mouse-pointer"></i>
        <span class="tooltip">Selection Tool (Debug)</span>
      </button>
      <button id="status-toggle-btn" class="toolbar-button">
        <i class="fas fa-tags"></i>
        <span class="tooltip">Status</span>
      </button>
      <button id="groups-toggle-btn" class="toolbar-button">
        <i class="fas fa-layer-group"></i>
        <span class="tooltip">Groups</span>
      </button>
      <button id="tree-reset-btn" class="toolbar-button">
        <i class="fas fa-home"></i>
        <span class="tooltip">Reset View</span>
      </button>
    </div>

    <!-- Tree Panel -->
    <div id="tree-panel" class="tree-panel panel-hidden">
      <div id="treeViewHeader">
        <h3>Model Structure</h3>
        <button id="tree-close-btn"><i class="fas fa-times"></i></button>
      </div>
      <input
        id="tree-search"
        type="text"
        placeholder="Search..."
        class="tree-search-input"
      />
      <div id="tree-container" class="tree-container"></div>
    </div>

    <!-- Info Panel -->
    <div id="infoPanel" class="info-panel panel-hidden">
      <div id="infoPanelHeader">
        <h3>Element Information</h3>
        <button id="info-close-btn"><i class="fas fa-times"></i></button>
      </div>
      <div id="infoPanelContent" class="info-content">
        <!-- Basic Info -->
        <div class="info-section">
          <div class="info-row">
            <div class="info-label">Name</div>
            <div class="info-value">-</div>
          </div>
          <div class="info-row">
            <div class="info-label">ID</div>
            <div class="info-value">-</div>
          </div>
          <div class="info-row">
            <div class="info-label">Active Status</div>
            <div class="info-value">
              <select id="element-active-status" class="status-select">
                <option value="">No status assigned</option>
              </select>
            </div>
          </div>
          <div class="info-actions">
            <button id="show-qr-btn" class="info-action-btn" title="Show QR Code">
              <i class="fas fa-qrcode"></i>
            </button>
            <button id="show-submissions-btn" class="info-action-btn" title="View Submissions">
              <i class="fas fa-bell"></i>
              <span id="submission-count" class="notification-badge">0</span>
            </button>
          </div>
        </div>

        <!-- Groups Section -->
        <div class="info-section">
          <div class="info-section-header">
            <h4>Groups</h4>
          </div>
          <div id="element-groups-list" class="element-groups-list">
            <!-- Groups will be populated here -->
          </div>
        </div>

        <!-- Status Section -->
        <div class="info-section">
          <div class="info-section-header">
            <h4>Status</h4>
          </div>
          <div id="element-status-list" class="element-status-list">
            <!-- Status will be populated here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Status Panel -->
    <div id="statusPanel" class="info-panel panel-hidden">
      <div id="statusPanelHeader">
        <h3>Status Management</h3>
        <button id="status-close-btn"><i class="fas fa-times"></i></button>
      </div>
      <div class="status-actions">
        <button id="add-status-btn" class="add-status-btn">
          <i class="fas fa-plus"></i> Add New Status
        </button>
      </div>
      <div id="statusListContent" class="status-list-content">
        <!-- Status items will be populated here -->
      </div>
    </div>

    <!-- Groups Panel -->
    <div id="groupsPanel" class="info-panel panel-hidden">
      <div id="groupsPanelHeader">
        <h3>Groups Management</h3>
        <button id="groups-close-btn"><i class="fas fa-times"></i></button>
      </div>
      <div class="status-actions">
        <button id="add-group-btn" class="add-status-btn">
          <i class="fas fa-plus"></i> Add New Group
        </button>
      </div>
      <div id="groupsListContent" class="status-list-content">
        <!-- Group items will be populated here -->
      </div>
    </div>

    <!-- Add/Edit Group Modal -->
    <div id="groupModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="groupModalTitle">Create New Group</h3>
          <button id="group-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Group Name</label>
            <input type="text" id="group-name-input" placeholder="Enter group name" />
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="group-description-input" placeholder="Enter description" rows="3"></textarea>
          </div>
          <div class="form-group">
            <label>Members (<span id="member-count">0</span>)</label>
            <button type="button" id="add-members-btn" class="add-members-btn">
              <i class="fas fa-user-plus"></i> Add Members
            </button>
            <div id="selected-members-display" class="selected-members-display">
              <!-- Selected members will be shown here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-group-btn" class="btn-secondary">Cancel</button>
          <button id="save-group-btn" class="btn-primary">
            <i class="fas fa-check"></i> <span id="save-group-text">Create</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Add Members Modal -->
    <div id="membersModal" class="modal">
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h3>Add Members to Group</h3>
          <button id="members-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <input type="text" id="members-search-input" placeholder="Search members..." class="search-input" />
          </div>
          <div id="members-list-container" class="members-list-container">
            <!-- Storey-wise member list with checkboxes will be populated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-members-btn" class="btn-secondary">Cancel</button>
          <button id="done-members-btn" class="btn-primary">
            <i class="fas fa-check"></i> Done (<span id="selected-count">0</span>)
          </button>
        </div>
      </div>
    </div>

    <!-- Select Groups Modal -->
    <div id="selectGroupsModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Add to Groups</h3>
          <button id="select-groups-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div id="select-groups-list" class="select-groups-list">
            <!-- Groups with checkboxes will be populated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-select-groups-btn" class="btn-secondary">Cancel</button>
          <button id="done-select-groups-btn" class="btn-primary">
            <i class="fas fa-check"></i> Done
          </button>
        </div>
      </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qrModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Element QR Code</h3>
          <button id="qr-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="qr-container">
            <canvas id="qr-canvas"></canvas>
          </div>
          <div class="qr-info">
            <p>Scan this QR code to view element details and submit reports</p>
          </div>
        </div>
        <div class="modal-footer">
          <button id="close-qr-btn" class="btn-secondary">Close</button>
        </div>
      </div>
    </div>

    <!-- Submissions Modal -->
    <div id="submissionsModal" class="modal">
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h3>Element Submissions</h3>
          <button id="submissions-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div id="submissions-list" class="submissions-list">
            <!-- Submissions will be populated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button id="close-submissions-btn" class="btn-secondary">Close</button>
        </div>
      </div>
    </div>

    <!-- Select Status Modal -->
    <div id="selectStatusModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Assign Status</h3>
          <button id="select-status-modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div id="select-status-list" class="select-status-list">
            <!-- Status with checkboxes will be populated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-select-status-btn" class="btn-secondary">Cancel</button>
          <button id="done-select-status-btn" class="btn-primary">
            <i class="fas fa-check"></i> Done
          </button>
        </div>
      </div>
    </div>

    <!-- Add Status Modal -->
    <div id="statusModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create New Status</h3>
          <button id="modal-close-btn"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Status Name</label>
            <input type="text" id="status-name-input" placeholder="Enter status name" />
          </div>
          <div class="form-group">
            <label>Icon</label>
            <div class="icon-select-wrapper">
              <button type="button" id="icon-select-btn" class="icon-select-btn">
                <span id="selected-icon-display">Select an icon</span>
                <i class="fas fa-chevron-down"></i>
              </button>
              <div id="icon-dropdown" class="icon-dropdown">
                <input type="text" id="icon-search" class="icon-search" placeholder="Search icons..." />
                <div id="icon-list" class="icon-list"></div>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label>Color</label>
            <div class="color-picker-wrapper">
              <input type="color" id="status-color-input" value="#3B82F6" />
              <input type="text" id="status-color-text" value="#3B82F6" readonly />
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="cancel-status-btn" class="btn-secondary">Cancel</button>
          <button id="create-status-btn" class="btn-primary">
            <i class="fas fa-check"></i> Create
          </button>
        </div>
      </div>
    </div>

    <!-- Status Bar -->
    <div id="statusBar">
      <div id="status">
        <i class="fas fa-circle"></i> Ready
      </div>
      <div id="stats">
        <div class="stat">
          <i class="fas fa-cube"></i>
          <span id="objectCount">0 objects</span>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
